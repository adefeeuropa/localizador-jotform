<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Compra do Livro: Uma Vida de Decisões</title>
    <style>
        /* A página agora só mostra uma mensagem de carregamento */
        body, html {
            font-family: 'Inter', sans-serif, Arial;
            font-size: 14px;
            color: #555;
            text-align: center;
            padding-top: 10px;
        }
    </style>
</head>
<body>
    <p>Obrigado pela sua preferência, por favor aguarde...</p>

    <script>
        // ======================= CONFIGURAÇÃO IMPORTANTE =======================
        
        // 1. COLE AQUI O URL COMPLETO DO SEU FORMULÁRIO JOTFORM
        const jotformUrl = 'https://form.jotform.com/adm.adefeeuropa/pedido-umavidadedecises';

        // 2. DEFINA O NOME DO PARÂMETRO QUE VAI USAR NO URL (ex: 'pais', 'country', etc.)
        const urlParameterName = 'pais';

        // 3. COLE AQUI A SUA CHAVE DA API DO IPGEOLOCATION.IO
        const apiKey = 'a5c838f2a099472aad172e90fd2bc79c';

        // =======================================================================


        // Função que é executada quando a página carrega
        async function processGeolocation() {
            
            // Verifica se as configurações foram preenchidas
            if (apiKey === 'SUA_CHAVE_API_AQUI' || jotformUrl === 'URL_DO_SEU_FORMULARIO_JOTFORM') {
                document.body.innerHTML = 'Erro: O código não foi configurado corretamente (URL do JotForm ou Chave de API).';
                return;
            }

            try {
                const response = await fetch(`https://api.ipgeolocation.io/ipgeo?apiKey=${apiKey}`);
                const data = await response.json();

                let countryName = 'desconhecido';
                if (data && data.country_name) {
                    countryName = data.country_name;
                }
                
                // Constrói o novo URL com o parâmetro do país
                const newUrl = `${jotformUrl}?${urlParameterName}=${encodeURIComponent(countryName)}`;
                
                // Redireciona a janela principal do navegador para o novo URL
                window.top.location.href = newUrl;

            } catch (error) {
                console.error('Erro no processo de geolocalização:', error);
                // Se falhar, redireciona mesmo assim com o país "desconhecido"
                const fallbackUrl = `${jotformUrl}?${urlParameterName}=desconhecido`;
                window.top.location.href = fallbackUrl;
            }
        }

        window.onload = processGeolocation;
    </script>
</body>
</html>
